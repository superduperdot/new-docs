openapi: 3.0.3
info:
  title: Brale Issuance and Orchestration API
  version: 2.3.1
  description: |
    Brale supports stablecoin issuance and orchestration, enabling businesses and
    ecosystems to create their own stablecoins and convert between fiat and stablecoins
    seamlessly. From stablecoin onramps, offramps, and swaps to custody and payouts, the
    Brale API makes it easy to build stablecoin-enabled products.

    NOTE: All resource IDs (including account_id, address_id, financial_institution_id,
    and automation_id) are KSUIDsâ€”26-character alphanumeric strings that are sortable
    by time. Examples showing UUIDs are incorrect.


    **What's new in 2.3.1**
    - Unified **Addresses** model for on-chain and off-chain endpoints
      - `Transfers` now accepts **address_id only** (no financial_institution_id)
      - Optional `branding` object to control bank statement presentation
    - Added off-chain rails: `ach_credit`, `same_day_ach_credit`, `ach_debit`, `same_day_ach_debit`, `rtp-credit`
    - Plaid endpoints moved to `/accounts/{account_id}/plaid/*`
    - `Financial Institutions` marked **deprecated** (migration path to **Addresses**)
    - Create Account now uses `CreateManagedAccountRequest` with `beneficial_owners`, `business_controller`, and `EndUserTosAttestation`.
    - Transfers now accept `brand` (replaces `branding`, still aliased in docs).
    - Plaid endpoints updated to return `address_id` and accept `transfer_types`.
    - Off-chain Address creation uses `CreateExternalAddressRequest` oneOf with bank + blockchain variants.
    - FI endpoints kept but marked deprecated; use Addresses instead.
    - `rtp_credit` is the canonical RTP rail name.
tags:
  - name: Accounts
    description: Endpoints related to managing customer accounts (KYB, details, etc.)
  - name: Transfers
    description: Endpoints for creating and retrieving transfers (fiat to stablecoins, etc.)
  - name: Addresses
    description: On-chain and off-chain endpoints (custodial or external) represented by a single Addresses resource
  - name: Financial Institutions
    description: Legacy (deprecated) bank endpoints. Use Addresses instead.
  - name: Automations
    description: Automated deposit addresses or onramps
  - name: Plaid
    description: Bank linking and ACH debit via Plaid.
  - name: Orders
    description: Legacy tag used for transfers in older specs.

servers:
  - url: https://api.brale.xyz
    description: Production server

# ==================== Security (Global) ====================
# This ensures every endpoint requires a Bearer token.
security:
  - BearerAuth: []

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      description: >
        Use the Bearer token returned from the Auth endpoint via OAuth2 client_credentials
        flow. Include the token in the "Authorization: Bearer <token>" header.
    oauth:
      type: oauth2
      flows:
        clientCredentials:
          tokenUrl: https://auth.brale.xyz/oauth2/token
          scopes:
            accounts:read: Read account details
            accounts:write: Create or update accounts
            addresses:read: Read address details
            addresses:write: Create addresses
            automations:read: Read automations
            automations:write: Create automations
            financial-institutions:read: Read FI details (legacy)
            financial-institutions:write: Create FI (legacy)
            transfers:read: Read transfers
            transfers:write: Create transfers

  schemas:
    ## --------------------- KSUID SCHEMA --------------------- ##
    Ksuid:
      title: Kusid
      type: string
      format: ksuid
      pattern: ^[a-zA-Z0-9]{26}$
      example: 2VcUIIsgARwVbEGlIYbhg6fGG57
    Pagination:
      title: Pagination
      description: Cursor-based pagination metadata
      type: object
      additionalProperties: false
      properties:
        page_size:
          type: integer
          example: 25
        next:
          type: string
          nullable: true
          example: g3QAAAABdw...
        prev:
          type: string
          nullable: true
          example: g3QAAAABdw...
      required:
        - page_size

    ## --------------------- ACCOUNTS --------------------- ##
    AccountCreateRequest:
      type: object
      properties:
        business_name:
          type: string
          example: ABC Company Inc
        ein:
          type: string
          example: 111-11-1111
        address:
          $ref: '#/components/schemas/AccountAddress'
        phone_number:
          type: string
          example: '2134678902'
        email:
          type: string
          format: email
          example: mark@example.com
        website:
          type: string
          example: abccompany.com
        ultimate_beneficial_owners:
          type: array
          items:
            $ref: '#/components/schemas/UltimateBeneficialOwner'
      required:
        - business_name
        - ein
        - address
        - phone_number
        - email
        - ultimate_beneficial_owners
    Account:
      title: Account
      type: object
      description: The details of a customer account
      properties:
        id:
          $ref: '#/components/schemas/Ksuid'
        status:
          type: string
          description: Current KYB / onboarding status of the account
          enum:
            - complete
            - pending
            - rejected
          example: complete
        business_name:
          type: string
          example: ABC Company Inc
        ein:
          type: string
          example: 111-11-1111
        address:
          $ref: '#/components/schemas/AccountAddress'
        phone_number:
          type: string
          example: '2134678902'
        email:
          type: string
          format: email
          example: mark@example.com
        website:
          type: string
          example: abccompany.com
        ultimate_beneficial_owners:
          type: array
          items:
            $ref: '#/components/schemas/UltimateBeneficialOwner'
    AccountAddress:
      title: AccountAddress
      type: object
      properties:
        street_line_1:
          type: string
          example: 123 Main St
        street_line_2:
          type: string
          example: Apt C
        city:
          type: string
          example: Des Moines
        state:
          type: string
          example: Iowa
        zip:
          type: string
          example: '12345'
        country:
          type: string
          example: USA
      required:
        - street_line_1
        - city
        - state
        - zip
        - country
    UltimateBeneficialOwner:
      title: UltimateBeneficialOwner
      type: object
      properties:
        name:
          type: string
          example: John Doe
        ssn:
          type: string
          example: 222-22-2222
        address:
          $ref: '#/components/schemas/AccountAddress'
      required:
        - name
        - ssn
        - address

    ## --------------------- TRANSFERS --------------------- ##
    Transfer:
      title: Transfer
      type: object
      properties:
        status:
          type: string
          description: Lifecycle stage of the transfer
          enum:
            - pending
            - processing
            - complete
            - canceled
          example: pending
        amount:
          $ref: '#/components/schemas/Amount'
        created_at:
          type: string
          format: date-time
          example: '2025-02-05T19:39:14.316Z'
        updated_at:
          type: string
          format: date-time
          example: '2025-02-05T19:39:14.316Z'
        source:
          $ref: '#/components/schemas/TransferEndpoint'
        destination:
          $ref: '#/components/schemas/TransferEndpoint'
    TransferEndpoint:
      title: TransferEndpoint
      type: object
      properties:
        value_type:
          type: string
          example: USD
        transfer_type:
          type: string
          example: wire
        address_id:
          $ref: '#/components/schemas/Ksuid'
      required:
        - address_id
        - value_type
        - transfer_type
    TransfersList:
      title: TransfersList
      description: List of transfers plus pagination cursors
      type: object
      additionalProperties: false
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        transfers:
          type: array
          items:
            $ref: '#/components/schemas/Transfer'
      required:
        - pagination
        - transfers
      example:
        pagination:
          next: g3QAAAABdw...
          page_size: 25
        transfers:
          - id: 30NoY6R1Ns2tRBcx1Kb16SnuXOW
            status: complete
            source:
              transaction_id: "0xdd5646ea\u2026"
              address_id: "2MhCCIHu\u2026"
              value_type: ACE
              transfer_type: base
            destination:
              transaction_id: "0xdd5646ea\u2026"
              address_id: "2O6asmN\u2026"
              value_type: ACE
              transfer_type: base
            updated_at: '2025-07-25T21:05:07.779018Z'
            created_at: '2025-07-25T21:03:55.364134Z'
            amount:
              value: '0.10'
              currency: USD
            note: null
    TransferCreateRequest:
      title: TransferCreateRequest
      type: object
      properties:
        amount:
          type: object
          properties:
            value:
              type: string
              example: '100'
            currency:
              type: string
              example: USD
          required:
            - value
            - currency
        source:
          $ref: '#/components/schemas/TransferEndpoint'
        destination:
          $ref: '#/components/schemas/TransferEndpoint'
        branding:
          $ref: '#/components/schemas/TransferBranding'
      required:
        - amount
        - source
        - destination
    GetAddressesResponse:
      type: object
      properties:
        addresses:
          type: array
          items:
            $ref: '#/components/schemas/Address'
    Address:
      title: Address
      type: object
      properties:
        id:
          $ref: '#/components/schemas/Ksuid'
        status:
          type: string
          enum:
            - pending
            - active
            - archived
          example: active
        name:
          type: string
          example: Solana Custodial Wallet
        address:
          type: string
          description: The on-chain wallet address
          example: 73uyt9HkEqx9bThYXWaUBP67sWsiJEsyJ5rSCieDx5me
        transfer_types:
          type: array
          items:
            type: string
          example:
            - solana
            - base
            - wire
    AddressReference:
      title: AddressReference
      type: object
      additionalProperties: false
      properties:
        id:
          $ref: '#/components/schemas/Ksuid'
        address:
          type: string
          example: '0xb518d4d6221d9a41d23d71cbce8e106e7aab8f9b'
      required:
        - id
        - address
    Amount:
      title: Amount
      type: object
      description: Monetary value with explicit currency
      additionalProperties: false
      properties:
        value:
          type: string
          example: '11234.88'
        currency:
          type: string
          example: USD
      required:
        - value
        - currency
    AddressBalanceResponse:
      title: AddressBalance
      type: object
      additionalProperties: false
      description: Balance of **one** token on **one** chain for a specific wallet
      properties:
        address:
          $ref: '#/components/schemas/AddressReference'
        balance:
          $ref: '#/components/schemas/Amount'
        transfer_type:
          type: string
          description: Blockchain where the balance lives
          enum:
            - solana
            - ethereum
            - polygon
            - base
            - arbitrum
            - canton
            - avalanche
            - base_sepolia
            - sepolia
            - solana_devnet
            - tempo_testnet
          example: solana
        value_type:
          type: string
          description: Token ticker
          example: SBC
      required:
        - address
        - balance
        - transfer_type
        - value_type
      example:
        address:
          id: 2VcUIIsgARwVbEGlIYbhg6fGG57
          address: 73uyt9HkEqx9bThYXWaUBP67sWsiJEsyJ5rSCieDx5me
        balance:
          value: '100.00'
          currency: SBC
        transfer_type: solana
        value_type: SBC
    Balance:
      title: Balance
      type: object
      properties:
        balance:
          type: string
          example: '100'
        value_type:
          type: string
          example: SBC
    AddressCreateRequest:
      oneOf:
        - $ref: '#/components/schemas/ExternalAddressOnchainCreate'
        - $ref: '#/components/schemas/ExternalAddressOffchainCreate'
    GetFinancialInstitutionsResponse:
      type: object
      properties:
        financial_institutions:
          type: array
          items:
            $ref: '#/components/schemas/FinancialInstitution'
    FinancialInstitutionCreateRequest:
      title: FinancialInstitutionCreateRequest
      type: object
      properties:
        name:
          type: string
          example: Business Checking Account
        transfer_type:
          type: array
          items:
            type: string
          example:
            - ach
            - wire
        bank_details:
          $ref: '#/components/schemas/BankDetails'
      required:
        - name
        - transfer_type
        - bank_details
    FinancialInstitution:
      title: FinancialInstitution
      type: object
      properties:
        id:
          $ref: '#/components/schemas/Ksuid'
        name:
          type: string
          example: Business Checking Account
        status:
          type: string
          enum:
            - processing
            - active
            - archived
          example: active
        bank_details:
          $ref: '#/components/schemas/BankDetails'
    BankDetails:
      title: Bank
      type: object
      properties:
        owner:
          type: string
          example: Jane Doe
        account_number:
          type: string
          example: '1234567890'
        routing_number:
          type: string
          example: 063108680
        name:
          type: string
          description: The name of the bank
          example: Example Bank
        address:
          $ref: '#/components/schemas/AccountAddress'
        account_type:
          type: string
          example: checking
      required:
        - owner
        - account_number
        - routing_number
        - name
        - account_type
    AutomationCreateRequest:
      title: AutomationCreateRequest
      type: object
      properties:
        name:
          type: string
          example: XYZ Onramp
        destination_address:
          $ref: '#/components/schemas/AutomationDestinationAddress'
      required:
        - name
        - destination_address
    AutomationDestinationAddress:
      title: AutomationDestinationAddress
      type: object
      properties:
        address_id:
          $ref: '#/components/schemas/Ksuid'
        value_type:
          type: string
          example: SBC
        transfer_type:
          type: string
          example: solana
      required:
        - address_id
        - value_type
        - transfer_type
    Automation:
      title: Automation
      type: object
      properties:
        id:
          $ref: '#/components/schemas/Ksuid'
        name:
          type: string
          example: Customer Onramp
        status:
          type: string
          example: complete
        wire_instructions:
          $ref: '#/components/schemas/WireInstructions'
        destinationAddress:
          $ref: '#/components/schemas/AutomationDestinationAddress'
    WireInstructions:
      title: WireInstructions
      type: object
      properties:
        beneficiary_name:
          type: string
          example: Jane Business
        bank_name:
          type: string
          example: Example Bank
        bank_address:
          type: string
          example: 456 Commerce St., Des Moines, IA 50309
        account_number:
          type: string
          example: '123456789'
        routing_number:
          type: string
          example: 063108680
        beneficiary_address:
          type: string
          example: 612 Commerce St., Des Moines, IA 50309
        memo:
          type: string
          example: AB1C23456789
    GetAutomationsResponse:
      title: AutomationListResponse
      type: object
      properties:
        automations:
          type: array
          items:
            $ref: '#/components/schemas/Automation'
    TransferType:
      type: string
      description: Rail or chain identifier
      enum:
        - wire
        - ach_credit
        - same_day_ach_credit
        - ach_debit
        - same_day_ach_debit
        - rtp_credit
        - solana
        - ethereum
        - polygon
        - base
        - arbitrum
        - canton
        - avalanche
        - base_sepolia
        - sepolia
        - solana_devnet
        - tempo_testnet
        - stellar
        - xrp_ledger
    ExternalAddressOnchainCreate:
      type: object
      required:
        - name
        - transfer_types
        - address
      properties:
        name:
          type: string
        transfer_types:
          type: array
          items:
            $ref: '#/components/schemas/TransferType'
          description: Must include a supported chain (e.g., ethereum, base, solana,
            xrp_ledger)
        address:
          type: string
          description: On-chain wallet address
    ExternalAddressOffchainCreate:
      type: object
      required:
        - transfer_types
      properties:
        name:
          type: string
        owner:
          type: string
          description: Account owner/beneficiary name
        transfer_types:
          type: array
          items:
            $ref: '#/components/schemas/TransferType'
          description: One or more rails (wire, ach_credit, same_day_ach_credit, ach_debit,
            same_day_ach_debit, rtp_credit)
        plaid_token:
          type: string
          description: Required when using ach_debit or same_day_ach_debit
        account_number:
          type: string
        routing_number:
          type: string
        account_type:
          type: string
          enum:
            - checking
            - savings
        bank_address:
          $ref: '#/components/schemas/AccountAddress'
        beneficiary_address:
          $ref: '#/components/schemas/AccountAddress'
        email:
          type: string
          format: email
    TransferBranding:
      type: object
      properties:
        account_id:
          type: string
          description: Account whose name should appear on bank statement line items
    DateTime:
      type: string
      format: date-time
      title: DateTime
      description: ISO-8601 timestamp that includes date and time
      example: '2020-01-01T12:00:00Z'
    USStreetAddress:
      type: object
      additionalProperties: false
      title: USStreetAddress
      required:
        - street_line_1
        - city
        - state
        - zip
      properties:
        street_line_1:
          type: string
          example: 100 Example St.
        street_line_2:
          type: string
          example: Suite 500
        city:
          type: string
          example: Springfield
        state:
          type: string
          example: CA
        zip:
          type: string
          example: '90001'
        country:
          type: string
          example: USA
    ControllingParty:
      type: object
      additionalProperties: false
      title: ControllingParty
      required:
        - first_name
        - last_name
        - dob
        - ssn
        - address
        - email
        - phone_number
      properties:
        first_name:
          type: string
          example: John
        last_name:
          type: string
          example: Doe
        dob:
          type: string
          example: YYYY-MM-DD
        ssn:
          type: string
          example: 123-45-6789
        address:
          $ref: '#/components/schemas/USStreetAddress'
        email:
          type: string
          example: a@b.com
        phone_number:
          type: string
          example: 515-555-1212
        ownership_percentage:
          type: number
          nullable: true
          example: 40
    EndUserTosAttestation:
      type: object
      additionalProperties: false
      title: EndUserTosAttestation
      required:
        - accepted_at
      properties:
        accepted_at:
          $ref: '#/components/schemas/DateTime'
        ip:
          type: string
          example: 203.0.113.42
        user_agent:
          type: string
          example: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:138.0) Gecko/20100101
            Firefox/138.0
        version:
          type: string
          example: '2025-04-01'
    CreateManagedAccountRequest:
      type: object
      additionalProperties: false
      title: CreateManagedAccountRequest
      required:
        - business_name
        - ein
        - address
        - phone_number
        - email
        - website
        - business_controller
        - tos_attestation
      properties:
        business_name:
          type: string
          example: My Customer
        ein:
          type: string
          example: '123456789'
        address:
          $ref: '#/components/schemas/USStreetAddress'
        beneficial_owners:
          type: array
          nullable: true
          items:
            $ref: '#/components/schemas/ControllingParty'
        ultimate_beneficial_owners:
          deprecated: true
          description: Deprecated alias of beneficial_owners.
          type: array
          items:
            $ref: '#/components/schemas/ControllingParty'
        business_controller:
          $ref: '#/components/schemas/ControllingParty'
        email:
          type: string
          example: a@b.com
        phone_number:
          type: string
          example: 515-555-1212
        tos_attestation:
          $ref: '#/components/schemas/EndUserTosAttestation'
        website:
          type: string
          example: https://example.com
        name:
          type: string
          example: My Account
    BrandData:
      type: object
      nullable: true
      additionalProperties: false
      required:
        - account_id
      properties:
        account_id:
          type: string
    PaymentData:
      type: object
      additionalProperties: false
      title: PaymentData
      properties:
        address_id:
          type: string
          description: Preferred Address identifier
        financial_institution_id:
          type: string
          deprecated: true
          description: "Legacy\u2014use address_id"
        transfer_type:
          type: string
        value_type:
          type: string
      required:
        - transfer_type
        - value_type
    CreateTransfer:
      type: object
      additionalProperties: false
      required:
        - amount
        - source
        - destination
      properties:
        amount:
          $ref: '#/components/schemas/Amount'
        source:
          $ref: '#/components/schemas/PaymentData'
        destination:
          $ref: '#/components/schemas/PaymentData'
        brand:
          $ref: '#/components/schemas/BrandData'
        note:
          type: string
      title: CreateTransfer
    CreateLinkTokenRequest:
      type: object
      title: CreateLinkTokenRequest
      properties:
        legal_name:
          type: string
          description: User's legal name
          example: John Doe
        email_address:
          type: string
          description: User's email address
          example: user@example.com
        phone_number:
          type: string
          description: User's phone number
          example: '+1234567890'
        date_of_birth:
          type: string
          description: User's date of birth
          example: '1990-01-01'
    LinkTokenResponse:
      type: object
      title: LinkTokenResponse
      required:
        - link_token
        - expiration
        - callback_url
      properties:
        link_token:
          type: string
          description: Plaid Link token
          example: link-sandbox-123456789
        expiration:
          type: string
          description: ISO 8601 expiration
          example: '2024-01-01T12:00:00Z'
        callback_url:
          type: string
          description: URL to POST the public token to after Plaid Link
          example: https://customer.com/webhooks/plaid-updates
    RegisterAccountWithTransferTypesRequest:
      type: object
      title: RegisterAccountWithTransferTypesRequest
      required:
        - public_token
        - customer_webhook_url
        - transfer_types
      properties:
        public_token:
          type: string
          description: Plaid public token
          example: public-sandbox-123456789
        customer_webhook_url:
          type: string
          format: uri
          description: Webhook for Plaid item updates
          example: https://customer.com/webhooks/plaid-updates
        transfer_types:
          type: array
          minItems: 1
          items:
            type: string
            example: ach_credit
          description: Rails to enable (e.g., ach_credit, wire, rtp_credit)
    RegisterAccountAddressResponse:
      type: object
      title: RegisterAccountAddressResponse
      required:
        - address_id
      properties:
        address_id:
          type: string
          description: ID of the created address
          example: addr_123456789
    CreateExternalBlockchainAddressRequest:
      type: object
      additionalProperties: false
      title: CreateExternalBlockchainAddressRequest
      required:
        - name
        - address
        - transfer_types
      properties:
        name:
          type: string
          example: Company External EVM Address
          nullable: true
        address:
          type: string
          example: '0xb518d4d6221d9a41d23d71cbce8e106e7aab8f9b'
        transfer_types:
          type: array
          items:
            type: string
            example: solana
    CreateExternalFinancialInstitutionRequest:
      type: object
      additionalProperties: false
      title: CreateExternalFinancialInstitutionRequest
      required:
        - owner
        - account_number
        - routing_number
        - bank_address
        - beneficiary_address
        - account_type
        - transfer_types
      properties:
        owner:
          type: string
          example: Jane Doe
        name:
          type: string
          example: First Last Bank
        account_number:
          type: string
          example: '123456789'
        routing_number:
          type: string
          example: '123456789'
        account_type:
          type: string
          example: checking
          enum:
            - checking
            - savings
        bank_address:
          $ref: '#/components/schemas/USStreetAddress'
        beneficiary_address:
          $ref: '#/components/schemas/USStreetAddress'
        transfer_types:
          type: array
          minItems: 1
          description: Rails to enable for this bank endpoint
          items:
            type: string
            example: ach_credit
          example:
            - ach_credit
            - wire
            - rtp_credit
    CreateExternalAddressRequest:
      type: object
      oneOf:
        - $ref: '#/components/schemas/CreateExternalBlockchainAddressRequest'
        - $ref: '#/components/schemas/CreateExternalFinancialInstitutionRequest'
      title: CreateExternalAddressRequest
paths:
  /accounts:
    get:
      tags:
        - Accounts
      operationId: listAccounts
      summary: Retrieve all accounts
      description: Returns an array of accounts.
      responses:
        '200':
          description: An array of accounts
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Account'
    post:
      tags:
        - Accounts
      operationId: createAccount
      summary: Create a customer account
      description: 'Creates a new customer (account) with the required KYC/KYB details.

        '
      parameters:
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
          example: idemp-123e4567-e89b-12d3-a456-426614174000
          description: 'A unique string used to prevent duplicate operations. Each POST
            request must use a new idempotency key. Use a UUIDv4 string. Example: `idemp-123e4567-e89b-12d3-a456-426614174000`

            '
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateManagedAccountRequest'
            examples:
              create_business_account:
                summary: Business account with controller + TOS attestation
                value:
                  business_name: ABC Company Inc
                  ein: 11-1111111
                  address:
                    street_line_1: 100 Example St
                    city: New York
                    state: NY
                    zip: '10001'
                    country: USA
                  phone_number: '2125550182'
                  email: ops@abc.example
                  website: https://abc.example
                  beneficial_owners:
                    - first_name: Jane
                      last_name: Doe
                      dob: '1980-05-12'
                      ssn: 222-22-2222
                      email: jane@example.com
                      phone_number: 212-555-0182
                      address:
                        street_line_1: 100 Example St
                        city: New York
                        state: NY
                        zip: '10001'
                        country: USA
                  business_controller:
                    first_name: Alicia
                    last_name: Ng
                    dob: '1986-07-14'
                    ssn: 123-45-6789
                    email: alicia.ng@example.com
                    phone_number: '+12125550182'
                    address:
                      street_line_1: 200 Market St
                      city: New York
                      state: NY
                      zip: '10002'
                      country: USA
                  tos_attestation:
                    accepted_at: '2025-05-13T20:45:15Z'
                    version: '2025-04-01'
                    ip: 203.0.113.42
                    user_agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36
                      ...
                  name: My Account
      responses:
        '201':
          description: Account successfully created
          content:
            '*/*':
              schema:
                type: object
                properties:
                  id:
                    $ref: '#/components/schemas/Ksuid'
  /accounts/{account_id}:
    get:
      tags:
        - Accounts
      operationId: getAccount
      summary: Retrieve a customer account
      description: Returns the details of a specific customer account, including KYB
        status.
      parameters:
        - name: account_id
          in: path
          required: true
          description: The ID of the account
          schema:
            $ref: '#/components/schemas/Ksuid'
      responses:
        '200':
          description: Details of the requested account
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/Account'
  /accounts/{account_id}/transfers:
    get:
      tags:
        - Transfers
        - Orders
      operationId: listTransfers
      summary: Get all transfers for a given account
      description: Returns a list of transfers associated with the specified account.
      parameters:
        - name: account_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the account
        - name: page[size]
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
          example: 50
          description: The number of transfers to return
        - name: page[next]
          in: query
          required: false
          schema:
            type: string
          example: g3QAAAABdw...
          description: Cursor for the next page (value returned in `pagination.next`)
        - name: page[prev]
          in: query
          required: false
          schema:
            type: string
          example: g3QAAAABdw...
          description: Cursor for the previous page (value returned in `pagination.prev`)
      responses:
        '200':
          description: A list of transfers
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Transfer'
    post:
      tags:
        - Transfers
        - Orders
      operationId: createTransfer
      summary: Create a new transfer
      description: Creates a new transfer using the specified source and destination
        details.
      parameters:
        - name: account_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the account
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
          example: idemp-123e4567-e89b-12d3-a456-426614174000
          description: 'A unique string used to prevent duplicate operations. Each POST
            request must use a new idempotency key. Use a UUIDv4 string. Example: `idemp-123e4567-e89b-12d3-a456-426614174000`

            '
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTransfer'
            examples:
              ach_debit_to_solana:
                summary: "Onramp via ACH debit \u2192 Mint on Solana"
                value:
                  amount:
                    value: '2500'
                    currency: USD
                  source:
                    address_id: addr_ach_debit
                    value_type: USD
                    transfer_type: ach_debit
                  destination:
                    address_id: addr_solana_internal
                    value_type: SBC
                    transfer_type: solana
              wire_offramp_with_branding:
                summary: "Burn on Polygon \u2192 Wire out (branding override)"
                value:
                  amount:
                    value: '10000'
                    currency: USD
                  source:
                    address_id: addr_polygon_internal
                    value_type: SBC
                    transfer_type: polygon
                  destination:
                    address_id: addr_wire_external
                    value_type: USD
                    transfer_type: wire
                  branding:
                    account_id: acct_company_beta
              rtp_payout:
                summary: Stablecoin payout via RTP
                value:
                  amount:
                    value: '150'
                    currency: USD
                  source:
                    address_id: addr_treasury_sbc
                    value_type: SBC
                    transfer_type: ethereum
                  destination:
                    address_id: addr_rtp_external
                    value_type: USD
                    transfer_type: rtp
              wire_offramp_with_brand:
                summary: "Burn on Polygon \u2192 Wire out (brand override)"
                value:
                  amount:
                    value: '10000'
                    currency: USD
                  source:
                    address_id: addr_polygon_internal
                    value_type: SBC
                    transfer_type: polygon
                  destination:
                    address_id: addr_wire_external
                    value_type: USD
                    transfer_type: wire
                  brand:
                    account_id: acct_company_beta
      responses:
        '201':
          description: Transfer successfully created
          content:
            '*/*':
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
                    example: 9f80c1f5-80df-4c5e-9b68-b9f5712d46d4
  /accounts/{account_id}/transfers/{id}:
    get:
      tags:
        - Transfers
      operationId: getTransfer
      summary: Retrieve a single transfer
      description: Returns details for a specific transfer.
      parameters:
        - name: account_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the account
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: The ID of the transfer (UUID)
      responses:
        '200':
          description: A single transfer object
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/Transfer'
  /accounts/{account_id}/addresses:
    get:
      tags:
        - Addresses
      operationId: listAddresses
      summary: Fetch all addresses
      description: 'Retrieves all addresses (internal and external) associated with
        the given account.

        '
      parameters:
        - name: account_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the account
      responses:
        '200':
          description: A list of addresses
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/GetAddressesResponse'
  /accounts/{account_id}/addresses/external:
    post:
      tags:
        - Addresses
      operationId: createAddress
      summary: Create a new external address
      description: 'Creates a non-custodial address (EOA) for the specified account.

        '
      parameters:
        - name: account_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the account
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
          example: idemp-123e4567-e89b-12d3-a456-426614174000
          description: 'A unique string used to prevent duplicate operations. Each POST
            request must use a new idempotency key. Use a UUIDv4 string. Example: `idemp-123e4567-e89b-12d3-a456-426614174000`

            '
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateExternalAddressRequest'
            examples:
              onchain_base:
                summary: On-chain (Base)
                value:
                  name: Base External Wallet
                  transfer_types:
                    - base
                  address: '0xE57e438aE0b1557bFC1ad70BD7751635E473D888'
              offchain_wire:
                summary: Off-chain (Wire)
                value:
                  owner: Jane Doe
                  transfer_types:
                    - wire
                  account_number: '1234567890'
                  routing_number: 063108680
                  account_type: checking
                  name: Example Bank
                  bank_address:
                    street_line_1: 100 Example St
                    street_line_2: Suite 500
                    city: Springfield
                    state: CA
                    zip: '90001'
                  beneficiary_address:
                    street_line_1: 100 Example St
                    street_line_2: Suite 500
                    city: Springfield
                    state: CA
                    zip: '90001'
              offchain_ach_debit:
                summary: Off-chain (ACH Debit via Plaid)
                value:
                  name: Operating Account (ACH Debit)
                  transfer_types:
                    - ach_debit
                    - same_day_ach_debit
                  plaid_token: PUBLIC_TOKEN_EXCHANGED_WITH_BRALE
      responses:
        '201':
          description: External address successfully created
          content:
            '*/*':
              schema:
                type: object
                properties:
                  id:
                    $ref: '#/components/schemas/Ksuid'
  /accounts/{account_id}/addresses/{address_id}/balance:
    get:
      tags:
        - Addresses
      operationId: getAddressBalance
      summary: Fetch the balance of an internal (custodial) address for a specific
        token
      description: 'Returns balance data for a given address, chain, and token.   Provide
        `transfer_type` and `value_type` as query parameters.

        '
      parameters:
        - name: account_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the account
        - name: address_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the address
        - name: transfer_type
          in: query
          required: false
          schema:
            type: string
          description: The blockchain environment (e.g., Solana, Ethereum)
        - name: value_type
          in: query
          required: false
          schema:
            type: string
          description: The stablecoin token or currency code
      responses:
        '200':
          description: The address details and balance info
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/AddressBalanceResponse'
  /accounts/{account_id}/financial-institutions:
    get:
      tags:
        - Financial Institutions
      operationId: ListFinancialInstitutions
      summary: Fetch all financial institutions
      description: 'Returns all financial institutions associated with the given account.



        Deprecated. Use Addresses. Create an off-chain Address (ACH/Wire/RTP) and
        pass its `address_id` to Transfers. Plaid endpoints have moved to `/accounts/{account_id}/plaid/*`.'
      parameters:
        - name: account_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the account
      responses:
        '200':
          description: A list of financial institutions
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/GetFinancialInstitutionsResponse'
      deprecated: true
  /accounts/{account_id}/financial-institutions/external:
    post:
      tags:
        - Financial Institutions
      operationId: createFinancialInstitution
      summary: Create a new external financial institution
      description: 'Links an external bank account to the specified account (ACH,
        wire, etc.).



        Deprecated. Use Addresses. Create an off-chain Address (ACH/Wire/RTP) and
        pass its `address_id` to Transfers. Plaid endpoints have moved to `/accounts/{account_id}/plaid/*`.'
      parameters:
        - name: account_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the account
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
          example: idemp-123e4567-e89b-12d3-a456-426614174000
          description: 'A unique string used to prevent duplicate operations. Each POST
            request must use a new idempotency key. Use a UUIDv4 string. Example: `idemp-123e4567-e89b-12d3-a456-426614174000`

            '
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FinancialInstitutionCreateRequest'
      responses:
        '201':
          description: Financial institution successfully created
          content:
            '*/*':
              schema:
                type: object
                properties:
                  id:
                    $ref: '#/components/schemas/Ksuid'
      deprecated: true
  /accounts/{account_id}/financial-institutions/{id}:
    get:
      tags:
        - Financial Institutions
      operationId: getFinancialInstitution
      summary: Fetch a specific financial institution
      description: 'Retrieves details for the specified financial institution (bank
        account).



        Deprecated. Use Addresses. Create an off-chain Address (ACH/Wire/RTP) and
        pass its `address_id` to Transfers. Plaid endpoints have moved to `/accounts/{account_id}/plaid/*`.'
      parameters:
        - name: account_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the account
        - name: id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the financial institution
      responses:
        '200':
          description: A financial institution object
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/FinancialInstitution'
      deprecated: true
  /accounts/{account_id}/automations:
    post:
      tags:
        - Automations
      operationId: createAutomations
      summary: Create an Automation
      description: 'Creates a new automation.

        '
      parameters:
        - name: account_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the account
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
          example: idemp-123e4567-e89b-12d3-a456-426614174000
          description: 'A unique string used to prevent duplicate operations. Each POST
            request must use a new idempotency key. Use a UUIDv4 string. Example: `idemp-123e4567-e89b-12d3-a456-426614174000`

            '
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AutomationCreateRequest'
      responses:
        '201':
          description: Automation successfully created
          content:
            '*/*':
              schema:
                type: object
                properties:
                  id:
                    $ref: '#/components/schemas/Ksuid'
    get:
      tags:
        - Automations
      operationId: listAutomations
      summary: Fetch all automations for an account
      description: 'Retrieves all automations associated with the specified customer
        account.

        '
      parameters:
        - name: account_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the account
      responses:
        '200':
          description: A list of automations
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/GetAutomationsResponse'
  /accounts/{account_id}/automations/{id}:
    get:
      tags:
        - Automations
      operationId: getAutomations
      summary: Retrieve a single automation
      description: Returns details for a specific automation.
      parameters:
        - name: account_id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the account
        - name: id
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Ksuid'
          description: The ID of the automation
      responses:
        '200':
          description: A single automation object
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/Automation'
  /accounts/{account_id}/plaid/link_token:
    post:
      tags:
        - Plaid
      summary: Create Plaid link token
      parameters:
        - in: path
          name: account_id
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateLinkTokenRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LinkTokenResponse'
  /accounts/{account_id}/plaid/register-account:
    post:
      tags:
        - Plaid
      summary: Register financial institution account via Plaid and return address
        ID
      parameters:
        - in: path
          name: account_id
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterAccountWithTransferTypesRequest'
      responses:
        '201':
          description: Created
          headers:
            Location:
              schema:
                type: string
              description: URL of the created address resource
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegisterAccountAddressResponse'
      description: Registers a bank using a Plaid public_token and returns the new
        Address ID.
x-tagGroups:
  - name: Core
    tags:
      - Accounts
      - Addresses
      - Transfers
      - Automations
      - Plaid
  - name: Legacy
    tags:
      - Financial Institutions
      - Orders
